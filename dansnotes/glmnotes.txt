


----------
mGLM notes
----------
to get the betas:
  KG x B = KX
  B=pinv(KG) x KX
  [also they're stored in prm file]
note F1=pinv(KG)
residuals=R x KX
once you have the betas, you can get the fits:
  KG x B [with undesired betas set to zero]

to plot a sum of resids and fits, for a given voxel:
  load KG
  load betas for that voxel, set unwanted to zero
  calc KG x B
  add in resid data if desired and available




calculatebetas:
  if tracerv != -1, divide sse by tracerv

KX=ifft(fft(signal)*fft(exofilt))
betas=F1*KXt
resid=R*KXt
SSE=Rt*R (divided by tracerv sometimes)


